<h2 id="description">Description</h2>

<p>predictPhases() is a function that reads the input dataset and makes prediction on the molecule states based on a pre-trained Machine Learning model.
It is similar to the <em>getPhases()</em> function, however it uses coordinates and distances array instead of the instance of the
System class as input.</p>

<p>The coordinates and distances arrays can be obtained using respectively the functions <a href="/mllpa/documentation/api/advanced/getcoordinates/">getCoordinates()</a>
and <a href="/mllpa/documentation/api/advanced/getdistances/">getDistances()</a>.
The models can be trained using the function <a href="/mllpa/documentation/api/common/generatemodel/">generateModel()</a>.</p>

<h2 id="argument-keywords-and-outputs">Argument, keywords and outputs</h2>

<h3 id="inputs--arguments">Input(s) / Argument(s)</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Flag</th>
      <th> Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Coordinates</td>
      <td> </td>
      <td>np.ndarray</td>
      <td>Array of the coordinates of the atoms of the molecules, merged between all systems and all frames. Dimension(s) should be in (N frames * N molecules, 2 * N atoms per molecule).</td>
    </tr>
    <tr>
      <td>Distances</td>
      <td> </td>
      <td>np.ndarray</td>
      <td>Array of the distances of the atoms of the molecules, merged between all systems and all frames. Dimension(s) should be in (N frames * N molecules, N distances).</td>
    </tr>
    <tr>
      <td>Models</td>
      <td> </td>
      <td>str or dict of models</td>
      <td>Path to the model file to load or dictionary of the Scikit-Learn models to use to predict the states of the molecules.</td>
    </tr>
  </tbody>
</table>

<h3 id="outputs">Output(s)</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th> Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Phases</td>
      <td>np.ndarray</td>
      <td>Array of all the molecule phases predicted in the system. Dimension(s) are in (N frames, N molecules).</td>
    </tr>
  </tbody>
</table>

<h2 id="examples">Examples</h2>

<h3 id="predict-the-phases-from-a-file">Predict the phases from a file</h3>

<p>The following example will analyse the coordinates array <em>coordinates_array</em> and the distances array <em>distances_array</em>
using the models pre-trained in the file <em>new_model.lpm</em> and return the phases of the molecules in
the variable <em>phase_array</em>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">mllpa</span>

<span class="n">phase_array</span> <span class="o">=</span> <span class="n">mllpa</span><span class="p">.</span><span class="n">predictPhases</span><span class="p">(</span><span class="n">coordinates_array</span><span class="p">,</span> <span class="n">distances_array</span><span class="p">,</span> <span class="s">"new_model.lpm"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="predict-the-phases-from-a-model-dictionary">Predict the phases from a model dictionary</h3>

<p>The following example will analyse the coordinates array <em>coordinates_array</em> and the distances array <em>distances_array</em>
using the models pre-trained in the variable <em>models</em> and return the phases of the molecules in
the variable <em>phase_array</em>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">phase_array</span> <span class="o">=</span> <span class="n">mllpa</span><span class="p">.</span><span class="n">predictPhases</span><span class="p">(</span><span class="n">coordinates_array</span><span class="p">,</span> <span class="n">distances_array</span><span class="p">,</span> <span class="n">models</span><span class="p">)</span>
</code></pre></div></div>
